function est=filtroRudo50hz(est)
% est=filtroRudo50hz(est)
% Filtro de 50hz con chebyshev de segundo grado entre 40 y 60 hz
%
X = get(est,'X');
datos = X.datos;

% matriz de coeficientes SOS
SOS(1,1:6) = [1.0000    1.5874    1.0000    1.0000    1.6036    0.9896];
    SOS(2,1:6) = [1.0000    0.2933    1.0000    1.0000    0.2245    0.9827];
    SOS(3,1:6) = [1.0000    1.5841    1.0000    1.0000    1.5839    0.9692];
    SOS(4,1:6) = [1.0000    0.3020    1.0000    1.0000    0.2296    0.9490];
    SOS(5,1:6) = [1.0000    1.5774    1.0000    1.0000    1.5612    0.9489];
    SOS(6,1:6) = [1.0000    0.3194    1.0000    1.0000    0.2432    0.9168];
    SOS(7,1:6) = [1.0000    1.5672    1.0000    1.0000    1.5354    0.9288];
    SOS(8,1:6) = [1.0000    0.3454    1.0000    1.0000    0.2648    0.8860];
    SOS(9,1:6) = [1.0000    1.5534    1.0000    1.0000    1.5063    0.9086];
    SOS(10,1:6) = [1.0000    0.3796    1.0000    1.0000    0.2941    0.8570];
    SOS(11,1:6) = [1.0000    1.5357    1.0000    1.0000    0.3304    0.8298];
    SOS(12,1:6) = [1.0000    0.4217    1.0000    1.0000    1.4738    0.8883];
    SOS(13,1:6) = [1.0000    1.5138    1.0000    1.0000    1.4376    0.8680];
    SOS(14,1:6) = [1.0000    0.4712    1.0000    1.0000    0.3732    0.8046];
    SOS(15,1:6) = [1.0000    1.4876    1.0000    1.0000    1.3976    0.8477];
    SOS(16,1:6) = [1.0000    0.5275    1.0000    1.0000    0.4220    0.7819];
    SOS(17,1:6) = [1.0000    1.4567    1.0000    1.0000    1.3536    0.8275];
    SOS(18,1:6) = [1.0000    0.5898    1.0000    1.0000    0.4761    0.7617];
    SOS(19,1:6) = [1.0000    1.4208    1.0000    1.0000    1.3056    0.8077];
    SOS(20,1:6) = [1.0000    0.6570    1.0000    1.0000    0.5349    0.7446];
    SOS(21,1:6) = [1.0000    1.3796    1.0000    1.0000    1.2535    0.7885];
    SOS(22,1:6) = [1.0000    0.7280    1.0000    1.0000    0.5976    0.7307];
    SOS(23,1:6) = [1.0000    1.3331    1.0000    1.0000    1.1975    0.7704];
    SOS(24,1:6) = [1.0000    0.8016    1.0000    1.0000    0.6635    0.7205];
    SOS(25,1:6) = [1.0000    1.2811    1.0000    1.0000    1.1377    0.7538];
    SOS(26,1:6) = [1.0000    0.8764    1.0000    1.0000    0.7316    0.7140];
    SOS(27,1:6) = [1.0000    1.2238    1.0000    1.0000    1.0746    0.7392];
    SOS(28,1:6) = [1.0000    0.9510    1.0000    1.0000    0.8011    0.7116];
    SOS(29,1:6) = [1.0000    1.1614    1.0000    1.0000    1.0086    0.7273];
    SOS(30,1:6) = [1.0000    1.0241    1.0000    1.0000    0.8711    0.7131];
    SOS(31,1:6) = [1.0000    1.0946    1.0000    1.0000    0.9405    0.7184];
    % Arreglo de ganacias
    G(1) = 0.9818;
    G(2) = 0.9818;
    G(3) = 0.9686;
    G(4) = 0.9686;
    G(5) = 0.9559;
    G(6) = 0.9559;
    G(7) = 0.9437;
    G(8) = 0.9437;
    G(9) = 0.9320;
    G(10) = 0.9320;
    G(11) = 0.9210;
    G(12) = 0.9210;
    G(13) = 0.9105;
    G(14) = 0.9105;
    G(15) = 0.9007;
    G(16) = 0.9007; 
    G(17) = 0.8917;
    G(18) = 0.8917;
    G(19) = 0.8836;
    G(20) = 0.8836;
    G(21) = 0.8765;
    G(22) = 0.8765;
    G(23) = 0.8704;
    G(24) = 0.8704;
    G(25) = 0.8656;
    G(26) = 0.8656;
    G(27) = 0.8621;
    G(28) = 0.8621;
    G(29) = 0.8599;
    G(30) = 0.8599;
    G(31) = 0.8592;
    G(32) = 1.0000;

%SOS
%G
%aplica las ganancias en SOS.
largo =length(SOS(:,1));
SOS2=SOS;

for i = 1:largo
    for j=1:3
        SOS2(i,j) = SOS(i,j)*G(i);
    end
end

% filtra los datos
datos = sosfilt(SOS2,datos); %filtra la señal....

X.datos = datos;
est = set(est,'X',X);